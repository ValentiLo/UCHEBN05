# **УП05. Разработка требований безопасности информационной системы ИНТЕРНЕТ-МАГАЗИНА**

## **1. Введение**

### **1.1. Цель документа**
Определение комплексных требований безопасности для защиты информационной системы интернет-магазина, обеспечивающих конфиденциальность, целостность и доступность данных.

### **1.2. Область действия**
Требования распространяются на:
- Веб-приложение и мобильное приложение
- Серверную инфраструктуру
- Базы данных
- Платежную систему
- Персональные данные пользователей
- Бизнес-процессы обработки заказов

---

## **2. Классификация активов и рисков**

### **2.1. Критичные активы**
| Актив | Уровень критичности | Описание |
|-------|-------------------|----------|
| База данных пользователей | Высокий | ПИИ, платежные данные, история заказов |
| Платежная информация | Высокий | Данные банковских карт, транзакции |
| Система обработки заказов | Высокий | Бизнес-процессы, финансовые операции |
| База товаров и цен | Средний | Каталог, остатки, ценообразование |
| Конфигурации системы | Средний | Настройки безопасности, API-ключи |

### **2.2. Основные угрозы**
- Неавторизованный доступ к данным пользователей
- SQL-инъекции и XSS-атаки
- Мошеннические транзакции
- DDoS-атаки на инфраструктуру
- Утечки данных через уязвимости API

---

## **3. Требования к аутентификации и авторизации**

### **3.1. Политика паролей**
```yaml
минимальная_длина: 8
обязательные_символы: [верхний_регистр, нижний_регистр, цифры, спец_символы]
блокировка_аккаунта: после 5 неудачных попыток
время_блокировки: 30 минут
срок_действия_пароля: 90 дней
```

### **3.2. Многофакторная аутентификация**
- Обязательная для администраторов системы
- Рекомендуемая для пользователей при включении в настройках
- Использование TOTP (Google Authenticator) или SMS-кодов

### **3.3. Управление сессиями**
```yaml
время_жизни_сессии: 30 минут
максимальное_время_бездействия: 15 минут
обязательный_логут: при закрытии браузера
контроль_параллельных_сессий: разрешено 3 одновременных входа
```

---

## **4. Требования к защите данных**

### **4.1. Шифрование данных**
| Тип данных | Алгоритм шифрования | Ключ шифрования |
|------------|-------------------|----------------|
| Пароли пользователей | bcrypt (соль 12 раундов) | - |
| Платежные данные | AES-256-GCM | HSM/Key Management Service |
| Персональные данные | AES-256-CBC | KMS с ротацией каждые 90 дней |
| Данные в передаче | TLS 1.2/1.3 | Сертификаты от доверенного CA |

### **4.2. Защита PII (Personal Identifiable Information)
```sql
-- Псевдонимизация данных в логах
Логировать: user_1234 совершил заказ
Не логировать: Иван Иванов (ivanov@mail.com) совершил заказ
```

### **4.3. Маскирование данных в UI**
- Отображение только последних 4 цифр банковской карты
- Частичное отображение email: us****@domain.com
- Скрытие полного номера телефона

---

## **5. Требования к веб-безопасности**

### **5.1. Защита от OWASP Top 10**
1. **Инъекции**
   - Подготовленные SQL-запросы (Prepared Statements)
   - Валидация и санитизация всех входных данных
   - Ограничение прав доступа БД (принцип наименьших привилегий)

2. **Межсайтовая подделка запроса (CSRF)**
   - CSRF-токены для всех state-changing операций
   - SameSite cookies атрибут

3. **XSS (Межсайтовый скриптинг)**
   - Content Security Policy (CSP)
   - Экранирование HTML-сущностей
   - HTTP-заголовки X-XSS-Protection

4. **Небезопасная десериализация**
   - Валидация сериализованных данных
   - Ограничение типов десериализуемых объектов

### **5.2. HTTP Security Headers**
```nginx
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Frame-Options: DENY
X-Content-Type-Options: nosniff
Referrer-Policy: strict-origin-when-cross-origin
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'
```

---

## **6. Требования к платежной безопасности (PCI DSS)**

### **6.1. Соответствие PCI DSS Level 1**
- Не хранить данные CVV/CVC после авторизации
- Использовать токенизацию для повторных платежей
- Регулярное сканирование уязвимостей (ASV)
- Ежеквартальные проверки сетевой безопасности

### **6.2. Сегментация сети**
```python
# Изоляция платежного окружения
Платежный_сегмент = {
    "доступ": ["только_авторизованные_IP", "VPN"],
    "логирование": ["все_операции", "Splunk/SIEM"],
    "мониторинг": ["24/7", "WAF", "IPS"]
}
```

---

## **7. Требования к API безопасности**

### **7.1. Аутентификация API**
```yaml
использовать: JWT + OAuth 2.0
время_жизни_токена: 15 минут
рефреш_токены: с_ротацией
проверка_scope: для_каждого_эндпоинта
```

### **7.2. Rate Limiting**
```yaml
аутентифицированные_пользователи: 1000 запросов/минуту
неаутентифицированные: 100 запросов/минуту
платежные_API: 50 запросов/минуту
```

### **7.3. Валидация запросов**
```json
{
  "максимальный_размер_запроса": "10MB",
  "разрешенные_content_types": ["application/json", "multipart/form-data"],
  "валидация_схемы": "JSON Schema для всех входных данных"
}
```

---

## **8. Требования к мониторингу и аудиту**

### **8.1. Логирование безопасности**
```yaml
события_для_логирования:
  - неудачные_попытки_входа
  - изменения_прав_доступа
  - доступ_к_чувствительным_данным
  - изменения_в_системе
  - платежные_транзакции

хранение_логов: 365 дней
анализ_логов: SIEM система
```

### **8.2. Система обнаружения вторжений (IDS)**
- Мониторинг подозрительной активности в реальном времени
- Анализ поведения пользователей (UEBA)
- Автоматическое блокирование IP при атаках

### **8.3. Пентест и сканирование уязвимостей**
```yaml
регулярность_пентеста: 2 раза в год
сканирование_уязвимостей: еженедельно
проверка_зависимостей: при каждом обновлении
анализ_кода: SAST в CI/CD
```

---

## **9. Требования к резервному копированию и восстановлению**

### **9.1. Политика бэкапов**
```yaml
данные_пользователей: ежедневно + инкрементальные каждые 4 часа
конфигурации: при каждом изменении
логи: ежечасно
шифрование_бэкапов: обязательно
проверка_восстановления: ежеквартально
```

### **9.2. RTO/RPO**
- Recovery Time Objective (RTO): 4 часа
- Recovery Point Objective (RPO): 15 минут

---

## **10. Организационные требования**

### **10.1. Обучение безопасности**
- Ежегодное обучение для всех сотрудников
- Специализированное обучение для разработчиков
- Тестирование на фишинг

### **10.2. Политика реагирования на инциденты**
```yaml
время_реагирования: 15 минут
эскалация: автоматическая при критических инцидентах
уведомление_пользователей: в течение 72 часов при утечке данных
```

### **10.3. Управление доступом**
- Принцип наименьших привилегий
- Регулярный пересмотр прав доступа (ежеквартально)
- Обязательный выход при увольнении

---

## **11. Требования к соответствию законодательству**

### **11.1. GDPR/152-ФЗ**
- Политика обработки персональных данных
- Право на забвение
- Уведомление надзорных органов в течение 72 часов

### **11.2. Локальные требования**
- Соответствие 152-ФЗ "О персональных данных"
- Хранение данных на территории РФ
- Согласие на обработку ПДн

---

## **12. Матрица соответствия требований**

| Требование | Статус | Ответственный | Срок реализации |
|------------|--------|---------------|-----------------|
| Внедрение MFA | Запланировано | Lead Dev | Q2 2024 |
| PCI DSS сертификация | В процессе | Security Officer | Q3 2024 |
| Внедрение SIEM | Реализовано | DevOps | Q1 2024 |
| Обучение сотрудников | Запланировано | HR | Q2 2024 |

---

## **Заключение**

Данные требования безопасности формиют основу для построения защищенной и отказоустойчивой системы интернет-магазина. Реализация всех перечисленных мер обеспечит:

- Защиту персональных данных пользователей
- Безопасность финансовых операций
- Соответствие международным и локальным стандартам
- Минимизацию рисков кибератак
- Поддержание репутации компании

Требования подлежат регулярному пересмотру и актуализации в соответствии с изменяющейся Threat Landscape и бизнес-потребностями.
